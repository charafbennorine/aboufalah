<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>aboufalah</title>
  <style>
    body {
      background-color: #0d0d0d;
      color: #fff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 10px;
    }

    .container {
      background: #1a1a1a;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 0 15px #ffc107;
      width: 100%;
      max-width: 360px;
    }

    input, select, button {
      width: 50%;
      padding: 14px;
      margin-top: 12px;
      font-size: 16px;
      border-radius: 10px;
      border: none;
      outline: none;
    }

    input, select {
      background-color: #2c2c2c;
      color: #fff;
    }

    button {
      background-color: #ffc107;
      color: #000;
      cursor: pointer;
      font-weight: bold;
    }

    #langToggle {
      position: fixed;
      top: 15px;
      right: 15px;
      background-color: #333;
      color: #fff;
      padding: 6px 12px;
      font-size: 14px;
      border-radius: 6px;
      cursor: pointer;
      z-index: 100;
    }
  </style>
</head>
<body>
  <div id="langToggle" onclick="toggleLanguage()">AR</div>
  <div class="container">
    <h2 id="mainTitle"> Competition Registration</h2>
    <p id="mainText">Please enter your information to join the event:</p>

    <input type="text" id="username" placeholder="Your full name">

    <select id="country">
      <option value="" disabled selected>🌍 Select Country</option>
      <option value="🇩🇿 Algeria">🇩🇿 Algeria</option>
      <option value="🇧🇭 Bahrain">🇧🇭 Bahrain</option>
      <option value="🇰🇲 Comoros">🇰🇲 Comoros</option>
      <option value="🇩🇯 Djibouti">🇩🇯 Djibouti</option>
      <option value="🇪🇬 Egypt">🇪🇬 Egypt</option>
      <option value="🇮🇶 Iraq">🇮🇶 Iraq</option>
      <option value="🇯🇴 Jordan">🇯🇴 Jordan</option>
      <option value="🇰🇼 Kuwait">🇰🇼 Kuwait</option>
      <option value="🇱🇧 Lebanon">🇱🇧 Lebanon</option>
      <option value="🇱🇾 Libya">🇱🇾 Libya</option>
      <option value="🇲🇷 Mauritania">🇲🇷 Mauritania</option>
      <option value="🇲🇦 Morocco">🇲🇦 Morocco</option>
      <option value="🇴🇲 Oman">🇴🇲 Oman</option>
      <option value="🇵🇸 Palestine">🇵🇸 Palestine</option>
      <option value="🇶🇦 Qatar">🇶🇦 Qatar</option>
      <option value="🇸🇦 Saudi Arabia">🇸🇦 Saudi Arabia</option>
      <option value="🇸🇴 Somalia">🇸🇴 Somalia</option>
      <option value="🇸🇩 Sudan">🇸🇩 Sudan</option>
      <option value="🇸🇾 Syria">🇸🇾 Syria</option>
      <option value="🇹🇳 Tunisia">🇹🇳 Tunisia</option>
      <option value="🇦🇪 United Arab Emirates">🇦🇪 United Arab Emirates</option>
      <option value="🇾🇪 Yemen">🇾🇪 Yemen</option>
      <option value="🇹🇷 Turkey">🇹🇷 Turkey</option>
      <option value="🇺🇸 United States">🇺🇸 United States</option>
      <option value="🇬🇧 United Kingdom">🇬🇧 United Kingdom</option>
      <option value="🇫🇷 France">🇫🇷 France</option>
      <option value="🇩🇪 Germany">🇩🇪 Germany</option>
      <option value="🇮🇹 Italy">🇮🇹 Italy</option>
      <option value="🇪🇸 Spain">🇪🇸 Spain</option>
      <option value="🇨🇦 Canada">🇨🇦 Canada</option>
      <option value="🇦🇺 Australia">🇦🇺 Australia</option>
    </select>

    <button onclick="checkAndSend()">Submit</button>
    <p id="statusMsg"></p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const registeredUsername = localStorage.getItem('registered_username');
      if (registeredUsername) {
        document.getElementById('statusMsg').textContent = '✅ لقد قمت بالتسجيل بلفعل!';
        document.getElementById('statusMsg').style.color = 'lightgreen';
        document.querySelector('button').disabled = true;
      }
    });

    async function getIpAddress() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        return data.ip;
      } catch (error) {
        console.error('Error fetching IP:', error);
        return 'N/A';
      }
    }

    async function checkAndSend() {
      const username = document.getElementById('username').value.trim();
      const registeredUsername = localStorage.getItem('registered_username');
      const status = document.getElementById('statusMsg');

      if (!username || username === "") {
        status.textContent = 'الرجاء إدخال الاسم.';
        status.style.color = 'orange';
        return;
      }

      if (registeredUsername && registeredUsername === username) {
        status.textContent = '✅you're already submitted!';
        status.style.color = 'lightgreen';
        document.querySelector('button').disabled = true;
        return;
      }
      sendToTelegram();
    }

    async function sendToTelegram() {
      const username = document.getElementById('username').value.trim();
      const country = document.getElementById('country').value.trim();
      const status = document.getElementById('statusMsg');

      if (!username || !country) {
        status.textContent = 'الرجاء ملء جميع الحقول المطلوبة!';
        status.style.color = 'orange';
        return;
      }

      const ip = await getIpAddress();

      const token = '6456489010:AAHxWt_1iqbOk7yWiU76djvQMMXToLcmEuU';
      const chat_id = 5830998075;
      const message = `🎯 تسجيل في المسابقة:\n\n👤 اسم المستخدم: ${username}\n🌍 الدولة: ${country}\n🌐 عنوان IP: ${ip}`;

      fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          chat_id: chat_id,
          text: message
        })
      })
      .then(response => response.json())
      .then(data => {
        if (data.ok) {
          localStorage.setItem('registered_username', username);
          status.textContent = '✅ تم تسجيلك بنجاح!';
          status.style.color = 'lightgreen';
          document.querySelector('button').disabled = true;
        } else {
          status.textContent = `❌ فشل الإرسال. الخطأ: ${data.description}`;
          status.style.color = 'red';
        }
      })
      .catch(error => {
        status.textContent = `⚠️ حدث خطأ: ${error.message}`;
        status.style.color = 'red';
      });
    }

    function toggleLanguage() {
      const isEnglish = document.documentElement.lang === 'en';
      document.documentElement.lang = isEnglish ? 'ar' : 'en';

      document.getElementById('mainTitle').textContent = isEnglish ? ' تسجيل في المسابقة' : ' Competition Registration';
      document.getElementById('mainText').textContent = isEnglish ? 'يرجى إدخال معلوماتك للمشاركة:' : 'Please enter your information to join the event:';
      document.getElementById('username').placeholder = isEnglish ? 'اسمك في لعبة' : 'Your HR username';
      document.querySelector("button").textContent = isEnglish ? 'إرسال' : 'Submit';
      document.getElementById('langToggle').textContent = isEnglish ? 'EN' : 'AR';
    }
  </script>
</body>
</html>


